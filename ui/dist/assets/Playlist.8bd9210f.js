import{P as w,F as x,G as N,A as I,E as C}from"./AddSong.a0d60334.js";import{_ as S,H as E,r as c,k as H,o as y,c as m,j as h,n as k,w as A,h as M,a as o,e as O,t as g,F as T,g as V,p as B,b as F,d as L,f as R}from"./index.3d6c7db9.js";import"./FindSources.2fb62c35.js";const q=new E("reapOne.playlist",22),G={components:{PlaylistEntry:w,FixedPlaylistHeader:x,GridHeader:N,AddSong:I,EditPlaylist:C},name:"Playlist",props:{authorised:Boolean,userData:Object},data(){var a,e,n;if(window.addEventListener("player.ended",r=>{this.updatePlaylist(r.detail.id);const u=this.playlist.findIndex(_=>_.id==r.detail.id);if(u>=this.playlist.length)return;const p=new CustomEvent("player.play",{detail:this.playlist[u+1]});window.dispatchEvent(p)}),this.updatePlaylist(),!this.getId()||!this.$route.path.includes("/playlist/"))return;const t=(n=(e=(a=this.userData)==null?void 0:a.data)==null?void 0:e.playlists)==null?void 0:n[Number(this.getId())],s=(t==null?void 0:t.songs)||[],i=(t==null?void 0:t.name)||"N/A",d=(t==null?void 0:t.description)||"";return document.title=`${i} - reAudioPlayer One`,{fixedHeaderHidden:!0,playlist:s,playlistName:i,playlistDescription:d}},methods:{getId(){return q.decode(this.$route.params.id)},download(t){var i;const s=(i=this.playlist)==null?void 0:i[t];window.open("/api/download/"+s.id)},updatePlaylist(){var s,i,d;if(!this.getId()||!this.$route.path.includes("/playlist/"))return;const t=(d=(i=(s=this.userData)==null?void 0:s.data)==null?void 0:i.playlists)==null?void 0:d[Number(this.getId())];this.playlist=(t==null?void 0:t.songs)||[],this.playlistName=(t==null?void 0:t.name)||"N/A",this.playlistDescription=(t==null?void 0:t.description)||"",document.title=`${this.playlistName} - reAudioPlayer One`},onPlaylistRearrange(t){const s=t.moved;!s||fetch("/api/rearrange",{method:"POST",body:JSON.stringify({playlistIndex:Number(this.getId()),songOldIndex:s.oldIndex,songNewIndex:s.newIndex})})},headerVisibilityChanged(t){this.fixedHeaderHidden=t},updateData(t){},loadPlaylist(){},addToPlaylist(){this.$refs.addSongPopup.showModal=!0},editPlaylist(){this.$refs.editPlaylistPopup.showModal=!0}},computed:{playlistCover(){var t,s;return(s=(t=this.playlist)==null?void 0:t[0])==null?void 0:s.cover},autogeneratedDescription(){var t,s,i;return`${(i=(s=(t=this.userData)==null?void 0:t.user)==null?void 0:s.userinfo)==null?void 0:i.name} \u2022 ${this.playlist.length} ${this.playlist.length==1?"song":"songs"}${this.estimatedDuration}`},estimatedDuration(){let t=0,s=!1;if(!this.playlist.length)return"";for(const n of this.playlist){s=s||n.duration=="-1:59";const r=n.duration=="-1:59"?"3:00":n.duration,[u,p]=r.split(":");t+=Number(u*60)+Number(p)}const i=t,d=Math.floor(i/60),a=Math.floor(d/60),e=s?", about ":", ";return a?e+`${a} hr ${d-a*60} min`:d?e+`${d} min ${i-d*60} sec`:e+t+" sec"}},watch:{$route(){this.updatePlaylist()},userData(){this.updatePlaylist()}}},f=t=>(B("data-v-970704d8"),t=t(),F(),t),U={class:"playlist"},z=["src"],J={class:"details"},K=R("Playlist"),Q={class:"muted description"},W={class:"mobileMenu showIfMobile"},X=f(()=>o("hr",null,null,-1)),Y={class:"padding-20"},Z={class:"grid"},$=f(()=>o("hr",null,null,-1)),j={class:"playlistEntries"};function tt(t,s,i,d,a,e){const n=c("AddSong"),r=c("EditPlaylist"),u=c("fixed-playlist-header"),p=c("h7"),_=c("grid-header"),P=c("playlist-entry"),v=H("observe-visibility");return y(),m("div",U,[h(n,{onClose:e.updatePlaylist,ref:"addSongPopup",userData:i.userData},null,8,["onClose","userData"]),h(r,{onClose:e.updatePlaylist,playlistName:a.playlistName,playlistDescription:a.playlistDescription,ref:"editPlaylistPopup",userData:i.userData},null,8,["onClose","playlistName","playlistDescription","userData"]),h(u,{onLoadPlaylist:e.loadPlaylist,ref:"fixedHeading",class:k({hidden:a.fixedHeaderHidden}),title:a.playlistName},null,8,["onLoadPlaylist","class","title"]),A((y(),m("div",{class:"padding-20 playlisteditor",onClick:s[0]||(s[0]=(...l)=>e.editPlaylist&&e.editPlaylist(...l))},[e.playlistCover?(y(),m("img",{key:0,class:"cover",src:e.playlistCover},null,8,z)):M("",!0),o("div",J,[h(p,{class:"hideIfMobile"},{default:O(()=>[K]),_:1}),o("h1",null,g(a.playlistName),1),o("h5",null,g(a.playlistDescription),1),o("p",Q,g(e.autogeneratedDescription),1)])])),[[v,e.headerVisibilityChanged]]),o("div",W,[o("span",{onClick:s[1]||(s[1]=()=>t.$emit("toggleFullSidebar")),class:"material-symbols-rounded"},"menu")]),X,o("div",Y,[o("span",{id:"loadPlaylist",onClick:s[2]||(s[2]=(...l)=>e.loadPlaylist&&e.loadPlaylist(...l)),class:"material-symbols-rounded"},"play_circle"),o("span",{id:"addToPlaylist",onClick:s[3]||(s[3]=(...l)=>e.addToPlaylist&&e.addToPlaylist(...l)),class:"material-symbols-rounded"},"add_circle"),o("div",Z,[h(_,{class:"hideIfMobile"}),$,o("div",j,[(y(!0),m(T,null,V(a.playlist,(l,D)=>(y(),L(P,{onDownload:e.download,key:D,onRequestUpdate:e.updatePlaylist,userData:i.userData,index:a.playlist.findIndex(b=>b.source==l.source),source:l.source,playing:l.playing,id:l.id,title:l.title,album:l.album,artist:l.artist,cover:l.cover,favourite:l.favourite,duration:l.duration},null,8,["onDownload","onRequestUpdate","userData","index","source","playing","id","title","album","artist","cover","favourite","duration"]))),128))])])])])}var lt=S(G,[["render",tt],["__scopeId","data-v-970704d8"]]);export{lt as default};
