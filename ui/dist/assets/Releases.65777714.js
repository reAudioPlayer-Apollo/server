import{F as I}from"./FullShelf.3dbb2cec.js";import{_ as w,o as r,c as n,a as l,t as u,g as f,r as h,i as k,d,w as p,F as m,e as v}from"./index.ce547255.js";import{C as N}from"./CollectionHeader.0914b1c6.js";const b={name:"ReleaseItem",methods:{redirect(){this.$refs.addAlbum.showModal=!0}},props:{cover:String,title:String,artist:String,href:String,releaseDate:String}},B={class:"wrapper"},C=["src"],R={key:0,class:"note"};function A(a,s,e,o,i,c){return r(),n("div",B,[l("div",{class:"item",onClick:s[0]||(s[0]=(..._)=>c.redirect&&c.redirect(..._))},[l("img",{src:e.cover},null,8,C),l("h4",null,u(e.title),1),l("p",null,u(e.artist),1),e.releaseDate?(r(),n("p",R,"Released on "+u(e.releaseDate),1)):f("",!0)])])}var x=w(b,[["render",A],["__scopeId","data-v-9940d4e4"]]);const F={name:"ReleaseItemBig",methods:{redirect(){this.$refs.addAlbum.showModal=!0}},props:{cover:String,title:String,artist:String,href:String,releaseDate:String}},O={class:"itemBig"},$=["src"],j={class:"wrapper"},T={key:0,class:"note"};function M(a,s,e,o,i,c){return r(),n("div",O,[l("div",{class:"item",onClick:s[0]||(s[0]=(..._)=>c.redirect&&c.redirect(..._))},[l("img",{src:e.cover},null,8,$),l("div",j,[l("h4",null,u(e.title),1),l("p",null,u(e.artist),1),e.releaseDate?(r(),n("p",T,"Released on "+u(e.releaseDate),1)):f("",!0)])])])}var H=w(F,[["render",M],["__scopeId","data-v-6b1e6eed"]]);const J={components:{CollectionHeader:N,FullShelf:I,Item:x,ItemBig:H},name:"Releases",props:{authorised:Boolean,userData:Object},data(){return{outSoon:[],outNow:[],outAlready:[]}},methods:{load(a){const s=new Date;for(const e of a){const o=new Date(e.releaseDate);s<o?this.outSoon.push(e):s.getMonth()==o.getMonth()&&s.getDate()==o.getDate()&&s.getFullYear()==o.getFullYear()?this.outNow.push(e):this.outAlready.push(e)}}},mounted(){var s,e;const a="apollo.releaseCache";if(window.localStorage.getItem(a))this.load(JSON.parse(window.localStorage.getItem(a)));else if(window.location.hash)fetch("/spotify/releaseRadar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({accessToken:window.location.hash.split("=")[1]})}).then(o=>o.json()).then(o=>{window.localStorage.setItem(a,JSON.stringify(o)),window.setTimeout(()=>window.localStorage.removeItem(a),30*60*1e3),this.load(o)});else if(((s=this.userData.data)==null?void 0:s.spotifyApiId)&&((e=this.userData.data)==null?void 0:e.spotifyApiSecret)){const o=window.location.href,i="user-follow-read playlist-modify-public";window.location.href=`https://accounts.spotify.com/authorize?client_id=${this.userData.data.spotifyApiId}&redirect_uri=${o.replace("#","%23")}&scope=${i}&response_type=token&state=123`}}},V={class:"padding-20"},Y={class:"releases"};function z(a,s,e,o,i,c){const _=h("CollectionHeader"),y=h("item-big"),g=h("full-shelf"),S=h("ItemBig"),D=h("Item");return r(),n("div",V,[k(_,{onToggleFullSidebar:s[0]||(s[0]=()=>a.$emit("toggleFullSidebar"))}),l("div",Y,[i.outSoon.length?(r(),d(g,{key:0,heading:"Out Soon"},{default:p(()=>[(r(!0),n(m,null,v(i.outSoon,t=>(r(),d(y,{key:t.url,releaseDate:t.releaseDate,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["releaseDate","cover","href","artist","title"]))),128))]),_:1})):f("",!0),i.outNow.length?(r(),d(g,{key:1,heading:"Out Now"},{default:p(()=>[(r(!0),n(m,null,v(i.outNow,t=>(r(),d(S,{key:t.url,releaseDate:t.releaseDate,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["releaseDate","cover","href","artist","title"]))),128))]),_:1})):f("",!0),i.outAlready.length?(r(),d(g,{key:2,heading:"Releases"},{default:p(()=>[(r(!0),n(m,null,v(i.outAlready,t=>(r(),d(D,{key:t.url,releaseDate:t.releaseDate,cover:t.cover,href:t.url,artist:t.artists.join(", "),title:t.title},null,8,["releaseDate","cover","href","artist","title"]))),128))]),_:1})):f("",!0)])])}var U=w(J,[["render",z],["__scopeId","data-v-2014cf6f"]]);export{U as default};
