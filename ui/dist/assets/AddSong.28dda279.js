import{_ as y,o as m,c as v,p as M,b as P,a as e,r as u,t as S,i as a,j as I,k as _,h as D,w as r,f as x,d as O,g as C,n as p,v as f,H as $}from"./index.74aa632f.js";const q={name:"GridHeader"},A=s=>(M("data-v-50c56ea2"),s=s(),P(),s),U={class:"gridHeader"},E=A(()=>e("span",{class:"id"},"#",-1)),H=A(()=>e("span",{class:"title"},"Title",-1)),F=A(()=>e("span",{class:"album"},"Album",-1)),j=A(()=>e("span",{class:"clock material-symbols-rounded"},"schedule",-1)),B=[E,H,F,j];function J(s,t,n,g,o,i){return m(),v("div",U,B)}var L=y(q,[["render",J],["__scopeId","data-v-50c56ea2"]]);const R={name:"FixedPlaylistHeader",components:{GridHeader:L},props:{title:String}},Y={class:"fixedPlaylistHeader"},z={class:"upperWrapper"};function G(s,t,n,g,o,i){const c=u("grid-header");return m(),v("div",Y,[e("div",z,[e("span",{id:"loadPlaylist",onClick:t[0]||(t[0]=d=>this.$emit("loadPlaylist")),class:"material-symbols-rounded"},"play_circle_filled"),e("h3",null,S(n.title),1)]),a(c,{class:"padding-20 darkback hideIfMobile"})])}var Ce=y(R,[["render",G],["__scopeId","data-v-3a25cb9b"]]);const W={name:"SongCtx",props:{liked:Boolean,isAutoPlaylist:Boolean},data(){return{playlists:[]}},methods:{hide(){this.$refs.contextmenu.hide()},show(s){const t=this.$refs.box.getBoundingClientRect(),n={top:t.height+t.top+window.scrollY,left:t.width+t.left+window.scrollX};this.$refs.contextmenu.show(n),s==null||s.stopPropagation()},like(){this.$emit("like")},remove(){this.$emit("remove")},addto(s){if(s==="new"){fetch("/api/playlist/create").then(t=>t.text()).then(t=>{this.$emit("addto",Number(t.replace("/playlist/","")))});return}this.$emit("addto",s)},download(){this.$emit("download")},update(){this.$emit("update")}}},X={ref:"box"},K=x("Remove from this playlist"),Q=x("Update Metadata");function Z(s,t,n,g,o,i){const c=u("v-contextmenu-item"),d=u("v-contextmenu-divider");u("v-contextmenu-submenu");const l=u("v-contextmenu"),k=I("contextmenu");return _((m(),v("div",X,[D(s.$slots,"default"),a(l,{ref:"contextmenu"},{default:r(()=>[a(c,{onClick:i.like},{default:r(()=>[x(S((n.liked?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1},8,["onClick"]),n.isAutoPlaylist?C("",!0):(m(),O(c,{key:0,onClick:i.remove},{default:r(()=>[K]),_:1},8,["onClick"])),C("",!0),a(d),a(c,{onClick:i.update},{default:r(()=>[Q]),_:1},8,["onClick"])]),_:1},512)])),[[k,void 0,"contextmenu"]])}var tt=y(W,[["render",Z]]);const et={name:"Marquee",mounted(){this.update(),window.addEventListener("resize",this.update)},data(){return{isMarquee:!1}},methods:{isTruncated(s){return s.scrollWidth>s.clientWidth},update(){this.isMarquee=!1,setTimeout(()=>{this.isMarquee=this.isTruncated(this.$refs.marquee)},10)}},props:{text:String},watch:{text(){this.update()}}},st={key:0,class:"replacer"},ot={key:0,class:"overlay"};function it(s,t,n,g,o,i){return m(),v("div",{class:p(["marqueeWrapper",{marquee:o.isMarquee}])},[e("span",{ref:"marquee",class:p({marquee:o.isMarquee})},[x(S(n.text)+" ",1),o.isMarquee?(m(),v("span",st,S(n.text),1)):C("",!0)],2),o.isMarquee?(m(),v("div",ot)):C("",!0)],2)}var nt=y(et,[["render",it],["__scopeId","data-v-dedb9b1e"]]);const lt={name:"FindSources",props:{artist:String,title:String},methods:{hide(){this.$refs.contextmenu.hide()},show(s){const t=this.$refs.box.getBoundingClientRect(),n={top:t.height+t.top+window.scrollY,left:t.width+t.left+window.scrollX};this.$refs.contextmenu.show(n),s==null||s.stopPropagation()},openSoundcloud(){window.open(`https://soundcloud.com/search?q=${this.artist} ${this.title}`)},openAudius(){window.open(`https://audius.co/search/${this.artist} ${this.title}`)},openYoutubeMusic(){window.open(`https://music.youtube.com/search?q=${this.artist} ${this.title}`)},openSpotify(){window.open(`https://open.spotify.com/search/${this.artist} ${this.title}`)}}},at={ref:"box"},dt=x("Soundcloud"),rt=x("Audius"),ct=x("Youtube Music"),ut=x("Spotify");function ht(s,t,n,g,o,i){const c=u("v-contextmenu-item"),d=u("v-contextmenu-submenu"),l=u("v-contextmenu"),k=I("contextmenu");return _((m(),v("div",at,[D(s.$slots,"default"),a(l,{ref:"contextmenu"},{default:r(()=>[a(d,{title:"Search on"},{default:r(()=>[a(c,{onClick:i.openSoundcloud},{default:r(()=>[dt]),_:1},8,["onClick"]),a(c,{onClick:i.openAudius},{default:r(()=>[rt]),_:1},8,["onClick"]),a(c,{onClick:i.openYoutubeMusic},{default:r(()=>[ct]),_:1},8,["onClick"]),a(c,{onClick:i.openSpotify},{default:r(()=>[ut]),_:1},8,["onClick"])]),_:1})]),_:1},512)])),[[k,void 0,"contextmenu"]])}var V=y(lt,[["render",ht]]);const _t={name:"EditSong",components:{FindSources:V},props:{cover:String,album:String,artist:String,source:String,title:String,id:Number,userData:Object},data(){return{showModal:!1,dCover:this.cover,dAlbum:this.album,dArtist:this.artist,dTitle:this.title,dSource:this.source}},methods:{opencontextmenu(s){this.$refs.findSourcesEdit.show(s)},hideFindSourcesCtx(){this.$refs.findSourcesEdit.hide()},add(){this.showModal=!1,console.log(this.userData);for(const s of this.userData.data.playlists)for(const t of s.songs)t.id==this.id&&(console.log("found one"),t.source=this.dSource,t.title=this.dTitle,t.album=this.dAlbum,t.artist=this.dArtist,t.cover=this.dCover);fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})},loadMetadata(){},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")}},watch:{id(){this.dCover=this.cover,this.dAlbum=this.album,this.dArtist=this.artist,this.dTitle=this.title,this.dSource=this.source}}},b=s=>(M("data-v-90cdf3f2"),s=s(),P(),s),mt={class:"wrapper"},pt={class:"header"},ft=b(()=>e("h3",null,"Edit song",-1)),vt=b(()=>e("span",{class:"material-symbols-rounded"}," close ",-1)),yt=[vt],gt=b(()=>e("h4",null,"Source",-1)),xt={class:"content"},bt=b(()=>e("h4",null,"Title",-1)),wt={class:"content"},St=b(()=>e("h4",null,"Album",-1)),kt={class:"content"},Ct=b(()=>e("h4",null,"Artist",-1)),Mt={class:"content"},Pt=b(()=>e("h4",null,"Cover",-1)),$t={class:"content"},At=["src"],Tt={class:"confirm"};function Nt(s,t,n,g,o,i){const c=u("FindSources"),d=u("vue-final-modal");return m(),v("div",null,[a(d,{onClick:i.hideFindSourcesCtx,modelValue:o.showModal,"onUpdate:modelValue":t[9]||(t[9]=l=>o.showModal=l),classes:"modal-container","content-class":"modal-content"},{default:r(()=>[e("div",mt,[e("div",pt,[ft,e("button",{class:"modal-close",onClick:t[0]||(t[0]=l=>o.showModal=!1)},yt)]),gt,a(c,{ref:"findSourcesEdit",title:n.title,artist:n.artist},{default:r(()=>[e("div",xt,[_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.dSource=l),type:"text",ref:"source"},null,512),[[f,o.dSource]]),e("span",{class:"material-symbols-rounded more",ref:"sourceMore",onClick:t[2]||(t[2]=(...l)=>i.opencontextmenu&&i.opencontextmenu(...l))},"more_vert",512)])]),_:1},8,["title","artist"]),bt,e("div",wt,[_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.dTitle=l),type:"text"},null,512),[[f,o.dTitle]])]),St,e("div",kt,[_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>o.dAlbum=l),type:"text",ref:"album"},null,512),[[f,o.dAlbum]])]),Ct,e("div",Mt,[_(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>o.dArtist=l),type:"text"},null,512),[[f,o.dArtist]])]),Pt,e("div",$t,[_(e("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t[6]||(t[6]=l=>o.dCover=l),ref:"cover"},null,512),[[f,o.dCover]]),e("img",{onClick:t[7]||(t[7]=(...l)=>i.openInNewTab&&i.openInNewTab(...l)),class:"addSong cover",src:n.cover?n.cover:"/assets/img/music_placeholder.png"},null,8,At)]),e("div",Tt,[e("button",{onClick:t[8]||(t[8]=(...l)=>i.add&&i.add(...l)),class:"negative"},"Save")])])]),_:1},8,["onClick","modelValue"])])}var It=y(_t,[["render",Nt],["__scopeId","data-v-90cdf3f2"]]);const Dt=new $("reapOne.track",22),Ot=new $("reapOne.playlist",22),Vt={name:"PlaylistEntry",components:{SongCtx:tt,Marquee:nt,EditSong:It},props:{index:Number,id:Number,source:String,artist:{type:String,default:"N/A"},cover:{type:String,default:"/assets/img/music_placeholder.png"},title:{type:String,default:"N/A"},album:{type:String,default:"N/A"},duration:{type:String,default:"N/A"},favourite:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},userData:Object},data(){return{highlighted:!1,favourited:this.favourite,isAutoPlaylist:this.$route.path=="/collection/tracks"}},computed:{trackId(){return Dt.encode(this.id)}},methods:{getPlaylistId(){return Ot.decode(this.$route.params.id)},download(){this.$emit("download",this.index)},addToPlaylist(s){fetch("/api/add",{method:"POST",body:JSON.stringify({id:s,source:this.source})}).then(t=>{t.status==200&&this.$emit("requestUpdate")})},remove(){fetch("/api/remove",{method:"POST",body:JSON.stringify({playlistId:Number(this.getPlaylistId()),songId:this.id})}).then(s=>{s.status==200&&this.$emit("requestUpdate")})},update(){this.$refs.editSongPopup.showModal=!0},hideCtxMenu(){this.$refs.ctxMenu.hide()},showCtxMenu(s){console.log("show"),this.$refs.ctxMenu.show(s)},onselect(){this.highlighted=!this.highlighted,this.hideCtxMenu()},displayPlay(){const s=this.$refs.idOrPlay;s.innerHTML="play_arrow",s.classList.add("material-symbols-rounded")},displayId(){const s=this.$refs.idOrPlay;s.innerHTML=this.index+1,s.classList.remove("material-symbols-rounded")},playAt(){console.log(this.$route.path);const s={index:this.index};this.$route.path.includes("/playlist/")&&(s.playlistIndex=Number(this.getPlaylistId())),this.$route.path.includes("/collection/tracks")&&(s.type="collection"),fetch("/api/at",{method:"POST",body:JSON.stringify(s)})},setFavourite(){for(const s of this.userData.data.playlists)for(const t of s.songs)if(t.id==this.id){if(t.favourite==this.favourited||0)return;t.favourite=this.favourited?1:0}fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})}},watch:{favourited(){this.setFavourite()},favourite(){console.log("mounted",this.title,this.favourite,this.favourited),this.favourited=this.favourite,this.highlighted=!1}}},qt={class:"track"},Ut=["src"],Et={class:"trackwrapper"},Ht={class:"duration"},Ft={class:"mobilePlaylist showIfMobile"},jt={class:"track"},Bt=["src"],Jt={class:"trackwrapper"};function Lt(s,t,n,g,o,i){const c=u("EditSong"),d=u("Marquee"),l=u("router-link"),k=u("SongCtx");return m(),O(k,{onDownload:i.download,onAddto:i.addToPlaylist,onRemove:i.remove,onUpdate:i.update,onLike:t[8]||(t[8]=h=>o.favourited=!o.favourited),isAutoPlaylist:o.isAutoPlaylist,liked:o.favourited,ref:"ctxMenu"},{default:r(()=>[a(c,{userData:n.userData,onClose:s.updatePlaylist,ref:"editSongPopup",cover:n.cover,id:n.id,title:n.title,album:n.album,artist:n.artist,source:n.source},null,8,["userData","onClose","cover","id","title","album","artist","source"]),e("div",{onDblclick:t[3]||(t[3]=()=>{i.playAt(),i.onselect()}),onClick:t[4]||(t[4]=(...h)=>i.onselect&&i.onselect(...h)),onMouseover:t[5]||(t[5]=(...h)=>i.displayPlay&&i.displayPlay(...h)),onMouseleave:t[6]||(t[6]=(...h)=>i.displayId&&i.displayId(...h)),class:p(["playlistEntry hideIfMobile",{selected:o.highlighted}])},[e("span",{onClick:t[0]||(t[0]=(...h)=>i.playAt&&i.playAt(...h)),ref:"idOrPlay",class:p([{playing:n.playing},"id"])},S(n.index+1),3),e("div",qt,[e("img",{src:n.cover||"/assets/img/music_placeholder.png"},null,8,Ut),e("div",Et,[e("span",{class:p(["title",{playing:n.playing}])},[a(l,{class:"linkOnHover",to:`/track/${i.trackId}`},{default:r(()=>[a(d,{text:n.title},null,8,["text"])]),_:1},8,["to"])],2),e("span",{class:p(["artist",{playing:n.playing}])},[a(l,{class:"linkOnHover",to:`/search/${n.artist}`},{default:r(()=>[a(d,{text:n.artist},null,8,["text"])]),_:1},8,["to"])],2)])]),e("span",{class:p(["album",{playing:n.playing}])},[a(d,{text:n.album},null,8,["text"])],2),e("span",{onClick:t[1]||(t[1]=h=>o.favourited=!o.favourited),class:p(["favourite material-symbols-rounded",{showfavourite:o.favourited||o.highlighted,active:o.favourited}])},"favorite",2),e("span",Ht,S(n.duration),1),e("span",{onClick:t[2]||(t[2]=(...h)=>i.showCtxMenu&&i.showCtxMenu(...h)),class:p(["more material-symbols-rounded",{hidden:!o.highlighted}])},"more_horiz",2)],34),e("div",Ft,[e("div",jt,[e("img",{src:n.cover||"/assets/img/music_placeholder.png"},null,8,Bt),e("div",Jt,[e("span",{class:p(["title",{playing:n.playing}])},[a(l,{class:"linkOnHover",to:`/track/${i.trackId}`},{default:r(()=>[a(d,{text:n.title},null,8,["text"])]),_:1},8,["to"])],2),e("span",{class:p(["artist",{playing:n.playing}])},[a(l,{class:"linkOnHover",to:`/search/${n.artist}`},{default:r(()=>[a(d,{text:n.artist},null,8,["text"])]),_:1},8,["to"])],2)])]),e("span",{onClick:t[7]||(t[7]=(...h)=>i.showCtxMenu&&i.showCtxMenu(...h)),class:"more material-symbols-rounded"},"more_horiz")])]),_:1},8,["onDownload","onAddto","onRemove","onUpdate","isAutoPlaylist","liked"])}var Me=y(Vt,[["render",Lt],["__scopeId","data-v-3f0e8386"]]);const N=new $("reapOne.playlist",22),Rt={name:"EditPlaylist",props:{playlistName:String,playlistDescription:String,userData:Object},data(){return{showModal:!1,cover:"",name:this.playlistName,description:this.playlistDescription}},methods:{apply(){this.showModal=!1,console.log("fetch"),this.userData.data.playlists[Number(N.decode(this.$route.params.id))].name=this.name,this.userData.data.playlists[Number(N.decode(this.$route.params.id))].description=this.description,fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})},remove(){this.userData.data.playlists.splice(Number(N.decode(this.$route.params.id)),1),fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})}},watch:{playlistName(){this.name=this.playlistName},playlistDescription(){this.description=this.playlistDescription}}},T=s=>(M("data-v-da852f16"),s=s(),P(),s),Yt={class:"wrapper"},zt={class:"header"},Gt=T(()=>e("h3",null,"Edit details",-1)),Wt=T(()=>e("span",{class:"material-symbols-rounded"}," close ",-1)),Xt=[Wt],Kt=T(()=>e("h4",null,"Name",-1)),Qt={class:"content"},Zt=T(()=>e("h4",null,"Description",-1)),te={class:"content"},ee={class:"confirm"};function se(s,t,n,g,o,i){const c=u("vue-final-modal");return m(),v("div",null,[a(c,{modelValue:o.showModal,"onUpdate:modelValue":t[5]||(t[5]=d=>o.showModal=d),classes:"modal-container","content-class":"modal-content"},{default:r(()=>[e("div",Yt,[e("div",zt,[Gt,e("button",{class:"modal-close",onClick:t[0]||(t[0]=d=>o.showModal=!1)},Xt)]),Kt,e("div",Qt,[_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>o.name=d),type:"text",ref:"name"},null,512),[[f,o.name]])]),Zt,e("div",te,[_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=d=>o.description=d),type:"text",ref:"description"},null,512),[[f,o.description]])]),e("div",ee,[e("button",{onClick:t[3]||(t[3]=(...d)=>i.remove&&i.remove(...d)),class:"negative left"},"Delete"),e("button",{onClick:t[4]||(t[4]=(...d)=>i.apply&&i.apply(...d)),class:"negative"},"Save")])])]),_:1},8,["modelValue"])])}var Pe=y(Rt,[["render",se],["__scopeId","data-v-da852f16"]]);const oe=new $("reapOne.playlist",22),ie={name:"AddSong",components:{FindSources:V},props:{userData:Object},data(){return{showModal:!1,cover:"",artist:"",title:""}},watch:{showModal(){!this.showModal||navigator.clipboard.readText().then(s=>{!this.isValidHttpUrl(s)||(this.$refs.source.value=s,this.loadMetadata())})}},methods:{isValidHttpUrl(s){let t;try{t=new URL(s)}catch{return!1}return t.protocol==="http:"||t.protocol==="https:"},opencontextmenu(s){this.$refs.findSources.show(s)},hideFindSourcesCtx(){this.$refs.findSources.hide()},getId(){return Number(oe.decode(this.$route.params.id))},add(){this.showModal=!1,this.userData.data.playlists[this.getId()].songs.push({source:this.$refs.source.value,title:this.title,artist:this.artist,album:this.$refs.album.value,cover:this.cover}),fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})},loadMetadata(){},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")}}},w=s=>(M("data-v-0ea6fbf4"),s=s(),P(),s),ne={class:"wrapper"},le={class:"header"},ae=w(()=>e("h3",null,"Add song",-1)),de=w(()=>e("span",{class:"material-symbols-rounded"}," close ",-1)),re=[de],ce=w(()=>e("h4",null,"Source",-1)),ue={class:"content"},he=w(()=>e("h4",null,"Title",-1)),_e={class:"content"},me=w(()=>e("h4",null,"Album",-1)),pe={class:"content"},fe={type:"text",ref:"album"},ve=w(()=>e("h4",null,"Artist",-1)),ye={class:"content"},ge=w(()=>e("h4",null,"Cover",-1)),xe={class:"content"},be=["src"],we={class:"confirm"};function Se(s,t,n,g,o,i){const c=u("FindSources"),d=u("vue-final-modal");return m(),v("div",null,[a(d,{onClick:i.hideFindSourcesCtx,modelValue:o.showModal,"onUpdate:modelValue":t[8]||(t[8]=l=>o.showModal=l),classes:"modal-container","content-class":"modal-content"},{default:r(()=>[e("div",ne,[e("div",le,[ae,e("button",{class:"modal-close",onClick:t[0]||(t[0]=l=>o.showModal=!1)},re)]),ce,a(c,{ref:"findSources",title:o.title,artist:o.artist},{default:r(()=>[e("div",ue,[e("input",{onChange:t[1]||(t[1]=(...l)=>i.loadMetadata&&i.loadMetadata(...l)),type:"text",ref:"source"},null,544),e("span",{class:"material-symbols-rounded more",ref:"sourceMore",onClick:t[2]||(t[2]=(...l)=>i.opencontextmenu&&i.opencontextmenu(...l))},"more_vert",512)])]),_:1},8,["title","artist"]),he,e("div",_e,[_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o.title=l),type:"text"},null,512),[[f,o.title]])]),me,e("div",pe,[e("input",fe,null,512)]),ve,e("div",ye,[_(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>o.artist=l),type:"text"},null,512),[[f,o.artist]])]),ge,e("div",xe,[_(e("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t[5]||(t[5]=l=>o.cover=l),ref:"cover"},null,512),[[f,o.cover]]),e("img",{onClick:t[6]||(t[6]=(...l)=>i.openInNewTab&&i.openInNewTab(...l)),class:"addSong cover",src:o.cover?o.cover:"/assets/img/music_placeholder.png"},null,8,be)]),e("div",we,[e("button",{onClick:t[7]||(t[7]=(...l)=>i.add&&i.add(...l)),class:"negative"},"Add")])])]),_:1},8,["onClick","modelValue"])])}var $e=y(ie,[["render",Se],["__scopeId","data-v-0ea6fbf4"]]);export{$e as A,Pe as E,Ce as F,L as G,Me as P};
