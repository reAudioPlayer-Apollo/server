import{_ as v,o as f,c as g,p as C,b as M,a as e,r as u,t as k,i as a,j as T,k as m,h as D,w as r,f as x,d as O,g as I,l as _,H as P,M as V,n as p}from"./index.d764ccfd.js";import{F as E}from"./FindSources.7fa996ed.js";const U={name:"GridHeader"},$=s=>(C("data-v-154a0bee"),s=s(),M(),s),F={class:"gridHeader"},H=$(()=>e("span",{class:"id"},"#",-1)),j=$(()=>e("span",{class:"title"},"Title",-1)),B=$(()=>e("span",{class:"album"},"Album",-1)),q=$(()=>e("span",{class:"clock material-symbols-rounded"},"schedule",-1)),J=[H,j,B,q];function L(s,t,l,y,i,o){return f(),g("div",F,J)}var R=v(U,[["render",L],["__scopeId","data-v-154a0bee"]]);const Y={name:"FixedPlaylistHeader",components:{GridHeader:R},props:{title:String}},G={class:"fixedPlaylistHeader"},z={class:"upperWrapper"};function X(s,t,l,y,i,o){const c=u("grid-header");return f(),g("div",G,[e("div",z,[e("span",{id:"loadPlaylist",onClick:t[0]||(t[0]=d=>this.$emit("loadPlaylist")),class:"material-symbols-rounded hideIfMobile"},"play_circle"),e("h3",null,k(l.title),1)]),a(c,{class:"padding-20 darkback hideIfMobile"})])}var Se=v(Y,[["render",X],["__scopeId","data-v-f98f5a0c"]]);const W={name:"SongCtx",props:{liked:Boolean,isAutoPlaylist:Boolean},data(){return{playlists:[]}},methods:{hide(){this.$refs.contextmenu.hide()},show(s){const t=this.$refs.box.getBoundingClientRect(),l={top:t.height+t.top+window.scrollY,left:t.width+t.left+window.scrollX};this.$refs.contextmenu.show(l),s==null||s.stopPropagation()},like(){this.$emit("like")},remove(){this.$emit("remove")},addto(s){if(s==="new"){fetch("/api/playlist/create").then(t=>t.text()).then(t=>{this.$emit("addto",Number(t.replace("/playlist/","")))});return}this.$emit("addto",s)},download(){this.$emit("download")},update(){this.$emit("update")}}},K={ref:"box"},Q=x("Remove from this playlist"),Z=x("Update Metadata");function tt(s,t,l,y,i,o){const c=u("v-contextmenu-item"),d=u("v-contextmenu-divider");u("v-contextmenu-submenu");const n=u("v-contextmenu"),S=T("contextmenu");return m((f(),g("div",K,[D(s.$slots,"default"),a(n,{ref:"contextmenu"},{default:r(()=>[a(c,{onClick:o.like},{default:r(()=>[x(k((l.liked?"Remove from":"Save to")+" your Liked Songs"),1)]),_:1},8,["onClick"]),l.isAutoPlaylist?I("",!0):(f(),O(c,{key:0,onClick:o.remove},{default:r(()=>[Q]),_:1},8,["onClick"])),I("",!0),a(d),a(c,{onClick:o.update},{default:r(()=>[Z]),_:1},8,["onClick"])]),_:1},512)])),[[S,void 0,"contextmenu"]])}var et=v(W,[["render",tt]]);const st={name:"EditSong",components:{FindSources:E},props:{cover:String,album:String,artist:String,source:String,title:String,id:Number,userData:Object},data(){return{showModal:!1,dCover:this.cover,dAlbum:this.album,dArtist:this.artist,dTitle:this.title,dSource:this.source}},methods:{opencontextmenu(s){this.$refs.findSourcesEdit.show(s)},hideFindSourcesCtx(){this.$refs.findSourcesEdit.hide()},add(){this.showModal=!1,console.log(this.userData);for(const s of this.userData.data.playlists)for(const t of s.songs)t.id==this.id&&(console.log("found one"),t.source=this.dSource,t.title=this.dTitle,t.album=this.dAlbum,t.artist=this.dArtist,t.cover=this.dCover);fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})},loadMetadata(){},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")}},watch:{id(){this.dCover=this.cover,this.dAlbum=this.album,this.dArtist=this.artist,this.dTitle=this.title,this.dSource=this.source}}},b=s=>(C("data-v-f97cb3b2"),s=s(),M(),s),ot={class:"wrapper"},it={class:"header"},nt=b(()=>e("h3",null,"Edit song",-1)),lt=b(()=>e("span",{class:"material-symbols-rounded"}," close ",-1)),at=[lt],dt=b(()=>e("h4",null,"Source",-1)),rt={class:"content"},ct=b(()=>e("h4",null,"Title",-1)),ut={class:"content"},ht=b(()=>e("h4",null,"Album",-1)),mt={class:"content"},_t=b(()=>e("h4",null,"Artist",-1)),pt={class:"content"},ft=b(()=>e("h4",null,"Cover",-1)),vt={class:"content"},yt=["src"],gt={class:"confirm"};function xt(s,t,l,y,i,o){const c=u("FindSources"),d=u("vue-final-modal");return f(),g("div",null,[a(d,{onClick:o.hideFindSourcesCtx,modelValue:i.showModal,"onUpdate:modelValue":t[9]||(t[9]=n=>i.showModal=n),classes:"modal-container","content-class":"modal-content"},{default:r(()=>[e("div",ot,[e("div",it,[nt,e("button",{class:"modal-close",onClick:t[0]||(t[0]=n=>i.showModal=!1)},at)]),dt,a(c,{ref:"findSourcesEdit",title:l.title,artist:l.artist},{default:r(()=>[e("div",rt,[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>i.dSource=n),type:"text",ref:"source"},null,512),[[_,i.dSource]]),e("span",{class:"material-symbols-rounded more",ref:"sourceMore",onClick:t[2]||(t[2]=(...n)=>o.opencontextmenu&&o.opencontextmenu(...n))},"more_vert",512)])]),_:1},8,["title","artist"]),ct,e("div",ut,[m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>i.dTitle=n),type:"text"},null,512),[[_,i.dTitle]])]),ht,e("div",mt,[m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>i.dAlbum=n),type:"text",ref:"album"},null,512),[[_,i.dAlbum]])]),_t,e("div",pt,[m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=n=>i.dArtist=n),type:"text"},null,512),[[_,i.dArtist]])]),ft,e("div",vt,[m(e("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t[6]||(t[6]=n=>i.dCover=n),ref:"cover"},null,512),[[_,i.dCover]]),e("img",{onClick:t[7]||(t[7]=(...n)=>o.openInNewTab&&o.openInNewTab(...n)),class:"addSong cover",src:l.cover?l.cover:"/assets/img/music_placeholder.png"},null,8,yt)]),e("div",gt,[e("button",{onClick:t[8]||(t[8]=(...n)=>o.add&&o.add(...n)),class:"negative"},"Save")])])]),_:1},8,["onClick","modelValue"])])}var bt=v(st,[["render",xt],["__scopeId","data-v-f97cb3b2"]]);const wt=new P("reapOne.track",22),St=new P("reapOne.playlist",22),kt={name:"PlaylistEntry",components:{SongCtx:et,Marquee:V,EditSong:bt},props:{index:Number,id:Number,source:String,artist:{type:String,default:"N/A"},cover:{type:String,default:"/assets/img/music_placeholder.png"},title:{type:String,default:"N/A"},album:{type:String,default:"N/A"},duration:{type:String,default:"N/A"},favourite:{type:Boolean,default:!1},playing:{type:Boolean,default:!1},userData:Object},data(){return{highlighted:!1,favourited:this.favourite,isAutoPlaylist:this.$route.path=="/collection/tracks"}},computed:{trackId(){return wt.encode(this.id)}},methods:{getPlaylistId(){return St.decode(this.$route.params.id)},download(){this.$emit("download",this.index)},addToPlaylist(s){fetch("/api/add",{method:"POST",body:JSON.stringify({id:s,source:this.source})}).then(t=>{t.status==200&&this.$emit("requestUpdate")})},remove(){fetch("/api/remove",{method:"POST",body:JSON.stringify({playlistId:Number(this.getPlaylistId()),songId:this.id})}).then(s=>{s.status==200&&this.$emit("requestUpdate")})},update(){this.$refs.editSongPopup.showModal=!0},hideCtxMenu(){this.$refs.ctxMenu.hide()},showCtxMenu(s){console.log("show"),this.$refs.ctxMenu.show(s)},onselect(){this.highlighted=!this.highlighted,this.hideCtxMenu()},displayPlay(){const s=this.$refs.idOrPlay;s.innerHTML="play_arrow",s.classList.add("material-symbols-rounded")},displayId(){const s=this.$refs.idOrPlay;s.innerHTML=this.index+1,s.classList.remove("material-symbols-rounded")},playAt(){console.log(this.$route.path),this.index,this.$route.path.includes("/playlist/")&&Number(this.getPlaylistId()),this.$route.path.includes("/collection/tracks");const s=new CustomEvent("player.play",{detail:{id:this.id,favourite:this.favourited,album:this.album,artist:this.artist,title:this.title,duration:this.duration,cover:this.cover,source:this.source}});window.dispatchEvent(s)},setFavourite(){for(const s of this.userData.data.playlists)for(const t of s.songs)if(t.id==this.id){if(t.favourite==this.favourited||0)return;t.favourite=this.favourited?1:0}fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})}},watch:{favourited(){this.setFavourite()},favourite(){console.log("mounted",this.title,this.favourite,this.favourited),this.favourited=this.favourite,this.highlighted=!1}}},Ct={class:"track"},Mt=["src"],Pt={class:"trackwrapper"},$t={class:"duration"},At={class:"mobilePlaylist showIfMobile"},Nt={class:"track"},It=["src"],Tt={class:"trackwrapper"};function Dt(s,t,l,y,i,o){const c=u("EditSong"),d=u("Marquee"),n=u("router-link"),S=u("SongCtx");return f(),O(S,{onDownload:o.download,onAddto:o.addToPlaylist,onRemove:o.remove,onUpdate:o.update,onLike:t[8]||(t[8]=h=>i.favourited=!i.favourited),isAutoPlaylist:i.isAutoPlaylist,liked:i.favourited,ref:"ctxMenu"},{default:r(()=>[a(c,{userData:l.userData,onClose:s.updatePlaylist,ref:"editSongPopup",cover:l.cover,id:l.id,title:l.title,album:l.album,artist:l.artist,source:l.source},null,8,["userData","onClose","cover","id","title","album","artist","source"]),e("div",{onDblclick:t[3]||(t[3]=()=>{o.playAt(),o.onselect()}),onClick:t[4]||(t[4]=(...h)=>o.onselect&&o.onselect(...h)),onMouseover:t[5]||(t[5]=(...h)=>o.displayPlay&&o.displayPlay(...h)),onMouseleave:t[6]||(t[6]=(...h)=>o.displayId&&o.displayId(...h)),class:p(["playlistEntry hideIfMobile",{selected:i.highlighted}])},[e("span",{onClick:t[0]||(t[0]=(...h)=>o.playAt&&o.playAt(...h)),ref:"idOrPlay",class:p([{playing:l.playing},"id"])},k(l.index+1),3),e("div",Ct,[e("img",{src:l.cover||"/assets/img/music_placeholder.png"},null,8,Mt),e("div",Pt,[e("span",{class:p(["title",{playing:l.playing}])},[a(n,{class:"linkOnHover",to:`/track/${o.trackId}`},{default:r(()=>[a(d,{text:l.title},null,8,["text"])]),_:1},8,["to"])],2),e("span",{class:p(["artist",{playing:l.playing}])},[a(n,{class:"linkOnHover",to:`/search/${l.artist}`},{default:r(()=>[a(d,{text:l.artist},null,8,["text"])]),_:1},8,["to"])],2)])]),e("span",{class:p(["album",{playing:l.playing}])},[a(d,{text:l.album},null,8,["text"])],2),e("span",{onClick:t[1]||(t[1]=h=>i.favourited=!i.favourited),class:p(["favourite material-symbols-rounded",{showfavourite:i.favourited||i.highlighted,active:i.favourited}])},"favorite",2),e("span",$t,k(l.duration),1),e("span",{onClick:t[2]||(t[2]=(...h)=>o.showCtxMenu&&o.showCtxMenu(...h)),class:p(["more material-symbols-rounded",{hidden:!i.highlighted}])},"more_horiz",2)],34),e("div",At,[e("div",Nt,[e("img",{src:l.cover||"/assets/img/music_placeholder.png"},null,8,It),e("div",Tt,[e("span",{class:p(["title",{playing:l.playing}])},[a(n,{class:"linkOnHover",to:`/track/${o.trackId}`},{default:r(()=>[a(d,{text:l.title},null,8,["text"])]),_:1},8,["to"])],2),e("span",{class:p(["artist",{playing:l.playing}])},[a(n,{class:"linkOnHover",to:`/search/${l.artist}`},{default:r(()=>[a(d,{text:l.artist},null,8,["text"])]),_:1},8,["to"])],2)])]),e("span",{onClick:t[7]||(t[7]=(...h)=>o.showCtxMenu&&o.showCtxMenu(...h)),class:"more material-symbols-rounded"},"more_horiz")])]),_:1},8,["onDownload","onAddto","onRemove","onUpdate","isAutoPlaylist","liked"])}var ke=v(kt,[["render",Dt],["__scopeId","data-v-77f3059a"]]);const N=new P("reapOne.playlist",22),Ot={name:"EditPlaylist",props:{playlistName:String,playlistDescription:String,userData:Object},data(){return{showModal:!1,cover:"",name:this.playlistName,description:this.playlistDescription}},methods:{apply(){this.showModal=!1,console.log("fetch"),this.userData.data.playlists[Number(N.decode(this.$route.params.id))].name=this.name,this.userData.data.playlists[Number(N.decode(this.$route.params.id))].description=this.description,fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})},remove(){this.userData.data.playlists.splice(Number(N.decode(this.$route.params.id)),1),fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})}},watch:{playlistName(){this.name=this.playlistName},playlistDescription(){this.description=this.playlistDescription}}},A=s=>(C("data-v-da852f16"),s=s(),M(),s),Vt={class:"wrapper"},Et={class:"header"},Ut=A(()=>e("h3",null,"Edit details",-1)),Ft=A(()=>e("span",{class:"material-symbols-rounded"}," close ",-1)),Ht=[Ft],jt=A(()=>e("h4",null,"Name",-1)),Bt={class:"content"},qt=A(()=>e("h4",null,"Description",-1)),Jt={class:"content"},Lt={class:"confirm"};function Rt(s,t,l,y,i,o){const c=u("vue-final-modal");return f(),g("div",null,[a(c,{modelValue:i.showModal,"onUpdate:modelValue":t[5]||(t[5]=d=>i.showModal=d),classes:"modal-container","content-class":"modal-content"},{default:r(()=>[e("div",Vt,[e("div",Et,[Ut,e("button",{class:"modal-close",onClick:t[0]||(t[0]=d=>i.showModal=!1)},Ht)]),jt,e("div",Bt,[m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=d=>i.name=d),type:"text",ref:"name"},null,512),[[_,i.name]])]),qt,e("div",Jt,[m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=d=>i.description=d),type:"text",ref:"description"},null,512),[[_,i.description]])]),e("div",Lt,[e("button",{onClick:t[3]||(t[3]=(...d)=>o.remove&&o.remove(...d)),class:"negative left"},"Delete"),e("button",{onClick:t[4]||(t[4]=(...d)=>o.apply&&o.apply(...d)),class:"negative"},"Save")])])]),_:1},8,["modelValue"])])}var Ce=v(Ot,[["render",Rt],["__scopeId","data-v-da852f16"]]);const Yt={name:"FindSources",props:{artist:String,title:String},methods:{hide(){this.$refs.contextmenu.hide()},show(s){const t=this.$refs.box.getBoundingClientRect(),l={top:t.height+t.top+window.scrollY,left:t.width+t.left+window.scrollX};this.$refs.contextmenu.show(l),s==null||s.stopPropagation()},openSoundcloud(){window.open(`https://soundcloud.com/search?q=${this.artist} ${this.title}`)},openAudius(){window.open(`https://audius.co/search/${this.artist} ${this.title}`)},openYoutubeMusic(){window.open(`https://music.youtube.com/search?q=${this.artist} ${this.title}`)},openSpotify(){window.open(`https://open.spotify.com/search/${this.artist} ${this.title}`)}}},Gt={ref:"box"},zt=x("Soundcloud"),Xt=x("Audius"),Wt=x("Youtube Music"),Kt=x("Spotify");function Qt(s,t,l,y,i,o){const c=u("v-contextmenu-item"),d=u("v-contextmenu-submenu"),n=u("v-contextmenu"),S=T("contextmenu");return m((f(),g("div",Gt,[D(s.$slots,"default"),a(n,{ref:"contextmenu"},{default:r(()=>[a(d,{title:"Search on"},{default:r(()=>[a(c,{onClick:o.openSoundcloud},{default:r(()=>[zt]),_:1},8,["onClick"]),a(c,{onClick:o.openAudius},{default:r(()=>[Xt]),_:1},8,["onClick"]),a(c,{onClick:o.openYoutubeMusic},{default:r(()=>[Wt]),_:1},8,["onClick"]),a(c,{onClick:o.openSpotify},{default:r(()=>[Kt]),_:1},8,["onClick"])]),_:1})]),_:1},512)])),[[S,void 0,"contextmenu"]])}var Zt=v(Yt,[["render",Qt]]);const te=new P("reapOne.playlist",22),ee={name:"AddSong",components:{FindSources:Zt},props:{userData:Object},data(){return{showModal:!1,cover:"",artist:"",title:""}},watch:{showModal(){!this.showModal||navigator.clipboard.readText().then(s=>{!this.isValidHttpUrl(s)||(this.$refs.source.value=s,this.loadMetadata())})}},methods:{isValidHttpUrl(s){let t;try{t=new URL(s)}catch{return!1}return t.protocol==="http:"||t.protocol==="https:"},opencontextmenu(s){this.$refs.findSources.show(s)},hideFindSourcesCtx(){this.$refs.findSources.hide()},getId(){return Number(te.decode(this.$route.params.id))},add(){this.showModal=!1,this.userData.data.playlists[this.getId()].songs.push({source:this.$refs.source.value,title:this.title,artist:this.artist,album:this.$refs.album.value,cover:this.cover,duration:"-1:59"}),fetch("/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.userData.data)}).then(s=>{console.log(s),this.$emit("close")})},loadMetadata(){},openInNewTab(){window.open(this.cover?this.cover:"/assets/img/music_placeholder.png")}}},w=s=>(C("data-v-0a4313ad"),s=s(),M(),s),se={class:"wrapper"},oe={class:"header"},ie=w(()=>e("h3",null,"Add song",-1)),ne=w(()=>e("span",{class:"material-symbols-rounded"}," close ",-1)),le=[ne],ae=w(()=>e("h4",null,"Source",-1)),de={class:"content"},re=w(()=>e("h4",null,"Title",-1)),ce={class:"content"},ue=w(()=>e("h4",null,"Album",-1)),he={class:"content"},me={type:"text",ref:"album"},_e=w(()=>e("h4",null,"Artist",-1)),pe={class:"content"},fe=w(()=>e("h4",null,"Cover",-1)),ve={class:"content"},ye=["src"],ge={class:"confirm"};function xe(s,t,l,y,i,o){const c=u("FindSources"),d=u("vue-final-modal");return f(),g("div",null,[a(d,{onClick:o.hideFindSourcesCtx,modelValue:i.showModal,"onUpdate:modelValue":t[8]||(t[8]=n=>i.showModal=n),classes:"modal-container","content-class":"modal-content"},{default:r(()=>[e("div",se,[e("div",oe,[ie,e("button",{class:"modal-close",onClick:t[0]||(t[0]=n=>i.showModal=!1)},le)]),ae,a(c,{ref:"findSources",title:i.title,artist:i.artist},{default:r(()=>[e("div",de,[e("input",{onChange:t[1]||(t[1]=(...n)=>o.loadMetadata&&o.loadMetadata(...n)),type:"text",ref:"source"},null,544),e("span",{class:"material-symbols-rounded more",ref:"sourceMore",onClick:t[2]||(t[2]=(...n)=>o.opencontextmenu&&o.opencontextmenu(...n))},"more_vert",512)])]),_:1},8,["title","artist"]),re,e("div",ce,[m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>i.title=n),type:"text"},null,512),[[_,i.title]])]),ue,e("div",he,[e("input",me,null,512)]),_e,e("div",pe,[m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=n=>i.artist=n),type:"text"},null,512),[[_,i.artist]])]),fe,e("div",ve,[m(e("input",{type:"text",class:"addSong cover","onUpdate:modelValue":t[5]||(t[5]=n=>i.cover=n),ref:"cover"},null,512),[[_,i.cover]]),e("img",{onClick:t[6]||(t[6]=(...n)=>o.openInNewTab&&o.openInNewTab(...n)),class:"addSong cover",src:i.cover?i.cover:"/assets/img/music_placeholder.png"},null,8,ye)]),e("div",ge,[e("button",{onClick:t[7]||(t[7]=(...n)=>o.add&&o.add(...n)),class:"negative"},"Add")])])]),_:1},8,["onClick","modelValue"])])}var Me=v(ee,[["render",xe],["__scopeId","data-v-0a4313ad"]]);export{Me as A,Ce as E,Se as F,R as G,ke as P};
